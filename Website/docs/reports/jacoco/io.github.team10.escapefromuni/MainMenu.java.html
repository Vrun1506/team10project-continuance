<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MainMenu.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">core</a> &gt; <a href="index.source.html" class="el_package">io.github.team10.escapefromuni</a> &gt; <span class="el_source">MainMenu.java</span></div><h1>MainMenu.java</h1><pre class="source lang-java linenums">package io.github.team10.escapefromuni;

import com.badlogic.gdx.Gdx;
import com.badlogic.gdx.Screen;
import com.badlogic.gdx.graphics.Color;
import com.badlogic.gdx.graphics.GL20;
import com.badlogic.gdx.graphics.Texture;
import com.badlogic.gdx.graphics.g2d.BitmapFont;
import com.badlogic.gdx.graphics.g2d.GlyphLayout;
import com.badlogic.gdx.math.Rectangle;
import com.badlogic.gdx.math.Vector2;

/**
 * OLD CLASS
 * Main menu screen displayed on game launch with menu options:
 *      Start Game, Tutorial, Settings, Achievements, Leaderboard, Exit.
 * NEW CHANGES:
 *      added new buttons for the achievements and leaderboard screens.
 */
public class MainMenu implements Screen {

    private final EscapeGame game;
    private Texture backgroundImage;
    private Texture buttonTexture;
    private BitmapFont font;
    private GlyphLayout layout;

    // buttons
    private Rectangle startButton;
    private Rectangle tutorialButton;
    private Rectangle settingsButton;
    private Rectangle exitButton;

    // NEW BUTTONS
    private Rectangle achievementButton;
    private Rectangle leaderboardButton;

    // hover states for buttons
    private boolean startHovered;
    private boolean tutorialHovered;
    private boolean settingsHovered;
    private boolean exitHovered;

    // NEW HOVER STATES
    private boolean achievementHovered;
    private boolean leaderboardHovered;

    /**
     * Initialises a new MainMenu object.
     * @param game the current EscapeGame object.
     */
<span class="nc" id="L52">    public MainMenu(EscapeGame game) {</span>
<span class="nc" id="L53">        this.game = game;</span>
<span class="nc" id="L54">    }</span>

    @Override
    public void show() {
        // backgrounds
<span class="nc" id="L59">        backgroundImage = new Texture(Gdx.files.internal(&quot;mainmenu_background.png&quot;));</span>
<span class="nc" id="L60">        buttonTexture = new Texture(Gdx.files.internal(&quot;ButtonBG.png&quot;));</span>

<span class="nc" id="L62">        font = game.font;</span>
<span class="nc" id="L63">        layout = new GlyphLayout();</span>

        // button sizes
<span class="nc" id="L66">        float buttonWidth = 400f;</span>
<span class="nc" id="L67">        float buttonHeight = 80f;</span>

        // alignment; To be Fixed
<span class="nc" id="L70">        float screenWidth = game.uiViewport.getWorldWidth();</span>
<span class="nc" id="L71">        float screenHeight = game.uiViewport.getWorldHeight();</span>
<span class="nc" id="L72">        float centerX = screenWidth / 2f;</span>

        // main menu button positions
<span class="nc" id="L75">        startButton = new Rectangle(centerX - buttonWidth / 2f, screenHeight / 2f + 150f, buttonWidth, buttonHeight);</span>
<span class="nc" id="L76">        tutorialButton = new Rectangle(centerX - buttonWidth / 2f, screenHeight / 2f + 50f, buttonWidth, buttonHeight);</span>
<span class="nc" id="L77">        settingsButton = new Rectangle(centerX - buttonWidth / 2f, screenHeight / 2f - 50f, buttonWidth, buttonHeight);</span>
<span class="nc" id="L78">        exitButton = new Rectangle(centerX - buttonWidth / 2f, screenHeight / 2f - 450f, buttonWidth, buttonHeight);</span>

        // NEW BUTTON LOCATIONS
<span class="nc" id="L81">        achievementButton = new Rectangle(centerX - buttonWidth / 2f, screenHeight / 2f - 150f, buttonWidth, buttonHeight);</span>
<span class="nc" id="L82">        leaderboardButton = new Rectangle(centerX - buttonWidth / 2f, screenHeight / 2f - 250f, buttonWidth, buttonHeight);</span>

        //menu music
<span class="nc" id="L85">        AudioManager.getInstance().playMenuMusic();</span>
<span class="nc" id="L86">    }</span>

    // Draws the main menu UI
    public void display() {
<span class="nc" id="L90">        game.viewport.apply();</span>
<span class="nc" id="L91">        game.batch.setProjectionMatrix(game.viewport.getCamera().combined);</span>
<span class="nc" id="L92">        game.batch.begin();</span>
<span class="nc" id="L93">        game.batch.draw(backgroundImage, 0, 0, game.viewport.getWorldWidth(), game.viewport.getWorldHeight());</span>
<span class="nc" id="L94">        game.batch.end();</span>

<span class="nc" id="L96">        game.uiViewport.apply();</span>
<span class="nc" id="L97">        game.batch.setProjectionMatrix(game.uiCamera.combined);</span>
<span class="nc" id="L98">        game.batch.begin();</span>

        // draw all main menu achievement_texts
<span class="nc" id="L101">        drawButton(startButton, &quot;Start Game&quot;, startHovered);</span>
<span class="nc" id="L102">        drawButton(tutorialButton, &quot;Tutorial&quot;, tutorialHovered);</span>
<span class="nc" id="L103">        drawButton(settingsButton, &quot;Settings&quot;, settingsHovered);</span>
<span class="nc" id="L104">        drawButton(exitButton, &quot;Exit&quot;, exitHovered);</span>

        // NEW BUTTON RENDERING
<span class="nc" id="L107">        drawButton(achievementButton, &quot;Achievements&quot;, achievementHovered);</span>
<span class="nc" id="L108">        drawButton(leaderboardButton, &quot;Leaderboard&quot;, leaderboardHovered);</span>

<span class="nc" id="L110">        game.batch.end();</span>
<span class="nc" id="L111">    }</span>

    /**
     * Draws the given button to the screen.
     * @param button the button to draw to the screen.
     * @param text the text the button should have.
     * @param hovered whether the button is currently hovered or not.
     */
    private void drawButton(Rectangle button, String text, boolean hovered) {

<span class="nc bnc" id="L121" title="All 2 branches missed.">        if (hovered) {</span>
<span class="nc" id="L122">            game.batch.setColor(1f, 1f, 0.5f, 1f);</span>
        } else {
<span class="nc" id="L124">            game.batch.setColor(Color.WHITE);</span>
        }

        //button bg,size etc
<span class="nc" id="L128">        game.batch.draw(buttonTexture, button.x, button.y, button.width, button.height);</span>
<span class="nc" id="L129">        game.batch.setColor(Color.WHITE);</span>

<span class="nc" id="L131">        layout.setText(font, text);</span>
<span class="nc" id="L132">        float textX = button.x + (button.width - layout.width) / 2f;</span>
<span class="nc" id="L133">        float textY = button.y + (button.height + layout.height) / 2f;</span>

<span class="nc" id="L135">        font.setColor(Color.WHITE);</span>
<span class="nc" id="L136">        font.draw(game.batch, layout, textX, textY);</span>
<span class="nc" id="L137">    }</span>

    /**
     * Checks if the button being currently hovered over is clicked.
     * @param button the current button
     * @return true if clicked, false otherwise.
     */
    private boolean isButtonClicked(Rectangle button) {
        // click detector
<span class="nc bnc" id="L146" title="All 2 branches missed.">        if (Gdx.input.justTouched()) {</span>
<span class="nc" id="L147">            Vector2 touchPos = new Vector2(Gdx.input.getX(), Gdx.input.getY());</span>
<span class="nc" id="L148">            game.uiViewport.unproject(touchPos);</span>

<span class="nc bnc" id="L150" title="All 2 branches missed.">            if (button.contains(touchPos.x, touchPos.y)) {</span>
<span class="nc" id="L151">                return true;</span>
            }
        }
<span class="nc" id="L154">        return false;</span>
    }

    /**
     * Checks if the current button is being hovered over.
     * @param button the current button.
     * @return true if hovered over, false otherwise.
     */
    private boolean isButtonHovered(Rectangle button) {
        // detect mouse hover in UI coordinates
<span class="nc" id="L164">        Vector2 mousePos = new Vector2(Gdx.input.getX(), Gdx.input.getY());</span>
<span class="nc" id="L165">        game.uiViewport.unproject(mousePos);</span>
<span class="nc" id="L166">        return button.contains(mousePos.x, mousePos.y);</span>
    }

    /**
     * Navigates the user to the main game screen.
     */
    public void onStartGame() {
<span class="nc" id="L173">        System.out.println(&quot;Starting game...&quot;);</span>
<span class="nc" id="L174">        game.setScreen(new GameScreen(game));</span>

        // NEW LOAD ACHIEVEMENTS
<span class="nc" id="L177">        game.achievementManager.loadAchievements();</span>
<span class="nc" id="L178">        dispose();</span>
<span class="nc" id="L179">    }</span>

    /**
     * Navigates the user to the tutorial screen.
     */
    public void onTutorial() {
<span class="nc" id="L185">        System.out.println(&quot;Opening tutorial...&quot;);</span>
<span class="nc" id="L186">        game.setScreen(new TutorialPage(game));</span>
<span class="nc" id="L187">        dispose();</span>
<span class="nc" id="L188">    }</span>

    /**
     * Navigates the user to the settings screen.
     */
    public void onSettings() {
<span class="nc" id="L194">        System.out.println(&quot;Opening settings...&quot;);</span>
<span class="nc" id="L195">        game.setScreen(new SettingsPage(game, this));</span>
<span class="nc" id="L196">        dispose();</span>
<span class="nc" id="L197">    }</span>

    /**
     * Quits the game.
     */
    public void onExit() {
<span class="nc" id="L203">        System.out.println(&quot;Exiting game...&quot;);</span>
<span class="nc" id="L204">        Gdx.app.exit();</span>
<span class="nc" id="L205">    }</span>

    // NEW
    /**
     * Navigates the user to the achievements screen.
     */
    public void onAchievements() {
<span class="nc" id="L212">        System.out.println(&quot;Going to achievement menu...&quot;);</span>
<span class="nc" id="L213">        game.setScreen(new AchievementScreen(game));</span>
<span class="nc" id="L214">        dispose();</span>
<span class="nc" id="L215">    }</span>

    // NEW
    /**
     * Navigates the user to the leaderboard screen.
     */
    public void onLeaderBoard() {
<span class="nc" id="L222">        System.out.println(&quot;Opening leaderboard...&quot;);</span>
<span class="nc" id="L223">        game.setScreen(new LeaderboardPage(game,this));</span>
<span class="nc" id="L224">        dispose();</span>
<span class="nc" id="L225">    }</span>

    @Override
    public void render(float delta) {

<span class="nc" id="L230">        Gdx.gl.glClearColor(0, 0, 0, 1);</span>
<span class="nc" id="L231">        Gdx.gl.glClear(GL20.GL_COLOR_BUFFER_BIT);</span>

<span class="nc" id="L233">        startHovered = isButtonHovered(startButton);</span>
<span class="nc" id="L234">        tutorialHovered = isButtonHovered(tutorialButton);</span>
<span class="nc" id="L235">        settingsHovered = isButtonHovered(settingsButton);</span>
<span class="nc" id="L236">        exitHovered = isButtonHovered(exitButton);</span>

        // NEW BUTTONS
<span class="nc" id="L239">        achievementHovered = isButtonHovered(achievementButton);</span>
<span class="nc" id="L240">        leaderboardHovered = isButtonHovered(leaderboardButton);</span>


<span class="nc bnc" id="L243" title="All 2 branches missed.">        if (isButtonClicked(startButton)) {</span>
<span class="nc" id="L244">            onStartGame();</span>
<span class="nc bnc" id="L245" title="All 2 branches missed.">        } else if (isButtonClicked(tutorialButton)) {</span>
<span class="nc" id="L246">            onTutorial();</span>
<span class="nc bnc" id="L247" title="All 2 branches missed.">        } else if (isButtonClicked(settingsButton)) {</span>
<span class="nc" id="L248">            onSettings();</span>
<span class="nc bnc" id="L249" title="All 2 branches missed.">        } else if (isButtonClicked(exitButton)) {</span>
<span class="nc" id="L250">            onExit();</span>

            // NEW BUTTON CHECKS
<span class="nc bnc" id="L253" title="All 2 branches missed.">        } else if (isButtonClicked(achievementButton)) {</span>
<span class="nc" id="L254">            onAchievements();</span>
<span class="nc bnc" id="L255" title="All 2 branches missed.">        } else if (isButtonClicked(leaderboardButton)) {</span>
<span class="nc" id="L256">            onLeaderBoard();</span>
        }

        // draw everything
<span class="nc" id="L260">        display();</span>
<span class="nc" id="L261">    }</span>

    @Override
    public void resize(int width, int height) {
<span class="nc" id="L265">        game.viewport.update(width, height, true);</span>
<span class="nc" id="L266">        game.uiViewport.update(width, height, true);</span>
<span class="nc" id="L267">    }</span>

    @Override
<span class="nc" id="L270">    public void pause() {}</span>

    @Override
<span class="nc" id="L273">    public void resume() {}</span>

    @Override
<span class="nc" id="L276">    public void hide() {}</span>

    @Override
    public void dispose() {
<span class="nc" id="L280">        backgroundImage.dispose();</span>
<span class="nc" id="L281">        buttonTexture.dispose();</span>
<span class="nc" id="L282">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>